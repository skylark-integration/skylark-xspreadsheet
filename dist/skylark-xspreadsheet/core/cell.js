/**
 * skylark-xspreadsheet - A version of xspreadsheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./alphabet","./helper"],function(e,p){"use strict";const s=p=>{const s=[],t=[];let r=[],n=0,l="",u=1,o="";for(let h=0;h<p.length;h+=1){const i=p.charAt(h);if(" "!==i){if(i>="a"&&i<="z")r.push(i.toUpperCase());else if(i>="0"&&i<="9"||i>="A"&&i<="Z"||"."===i)r.push(i);else if('"'===i){for(h+=1;'"'!==p.charAt(h);)r.push(p.charAt(h)),h+=1;t.push(`"${r.join("")}`),r=[]}else if("-"===i&&/[+\-*/,(]/.test(o))r.push(i);else{if("("!==i&&r.length>0&&t.push(r.join("")),")"===i){let p=s.pop();if(2===n)try{const[s,r]=e.expr2xy(t.pop()),[n,l]=e.expr2xy(t.pop());let u=0;for(let p=n;p<=s;p+=1)for(let s=l;s<=r;s+=1)t.push(e.xy2expr(p,s)),u+=1;t.push([p,u])}catch(e){}else if(1===n||3===n)3===n&&t.push(l),t.push([p,u]),u=1;else for(;"("!==p&&(t.push(p),!(s.length<=0));)p=s.pop();n=0}else if("="===i||">"===i||"<"===i){const e=p.charAt(h+1);l=i,"="!==e&&"-"!==e||(l+=e,h+=1),n=3}else if(":"===i)n=2;else if(","===i)3===n&&t.push(l),n=1,u+=1;else if("("===i&&r.length>0)s.push(r.join(""));else{if(s.length>0&&("+"===i||"-"===i)){let e=s[s.length-1];if("("!==e&&t.push(s.pop()),"*"===e||"/"===e)for(;s.length>0&&"("!==(e=s[s.length-1]);)t.push(s.pop())}else if(s.length>0){const e=s[s.length-1];"*"!==e&&"/"!==e||t.push(s.pop())}s.push(i)}r=[]}o=i}}for(r.length>0&&t.push(r.join(""));s.length>0;)t.push(s.pop());return t},t=(p,s)=>{const[t]=p;let r=p;if('"'===t)return p.substring(1);let n=1;if("-"===t&&(r=p.substring(1),n=-1),r[0]>="0"&&r[0]<="9")return n*Number(r);const[l,u]=e.expr2xy(r);return n*s(l,u)},r=(e,n,l,u=[])=>{if("="===e[0]){const o=s(e.substring(1));return o.length<=0?e:((e,s,r,n)=>{const l=[];for(let u=0;u<e.length;u+=1){const o=e[u],h=o[0];if("+"===o){const e=l.pop();l.push(p.numberCalc("+",l.pop(),e))}else if("-"===o)if(1===l.length){const e=l.pop();l.push(p.numberCalc("*",e,-1))}else{const e=l.pop();l.push(p.numberCalc("-",l.pop(),e))}else if("*"===o)l.push(p.numberCalc("*",l.pop(),l.pop()));else if("/"===o){const e=l.pop();l.push(p.numberCalc("/",l.pop(),e))}else if("="===h||">"===h||"<"===h){let e=l.pop();Number.isNaN(e)||(e=Number(e));let p=l.pop();Number.isNaN(p)||(p=Number(p));let s=!1;"="===h?s=p===e:">"===o?s=p>e:">="===o?s=p>=e:"<"===o?s=p<e:"<="===o&&(s=p<=e),l.push(s)}else if(Array.isArray(o)){const[e,p]=o,t=[];for(let e=0;e<p;e+=1)t.push(l.pop());l.push(s[e].render(t.reverse()))}else{if(n.includes(o))return 0;(h>="a"&&h<="z"||h>="A"&&h<="Z")&&n.push(o),l.push(t(o,r)),n.pop()}}return l[0]})(o,n,(e,p)=>r(l(e,p),n,l,u),u)}return e};return{render:r,infixExprToSuffixExpr:s}});
//# sourceMappingURL=../sourcemaps/core/cell.js.map
