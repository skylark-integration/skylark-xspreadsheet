/**
 * skylark-xspreadsheet - A version of xspreadsheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./cell_range"],function(t){"use strict";class e{constructor(t,e,r){this.ci=t,this.operator=e,this.value=r}set(t,e){this.operator=t,this.value=e}includes(t){const{operator:e,value:r}=this;return"all"===e||"in"===e&&r.includes(t)}vlength(){const{operator:t,value:e}=this;return"in"===t?e.length:0}getData(){const{ci:t,operator:e,value:r}=this;return{ci:t,operator:e,value:r}}}class r{constructor(t,e){this.ci=t,this.order=e}asc(){return"asc"===this.order}desc(){return"desc"===this.order}}return class{constructor(){this.ref=null,this.filters=[],this.sort=null}setData({ref:t,filters:s,sort:i}){null!=t&&(this.ref=t,this.fitlers=s.map(t=>new e(t.ci,t.operator,t.value)),i&&(this.sort=new r(i.ci,i.order)))}getData(){if(this.active()){const{ref:t,filters:e,sort:r}=this;return{ref:t,filters:e.map(t=>t.getData()),sort:r}}return{}}addFilter(t,r,s){const i=this.getFilter(t);null==i?this.filters.push(new e(t,r,s)):i.set(r,s)}setSort(t,e){this.sort=e?new r(t,e):null}includes(t,e){return!!this.active()&&this.hrange().includes(t,e)}getSort(t){const{sort:e}=this;return e&&e.ci===t?e:null}getFilter(t){const{filters:e}=this;for(let r=0;r<e.length;r+=1)if(e[r].ci===t)return e[r];return null}filteredRows(t){const e=new Set,r=new Set;if(this.active()){const{sri:s,eri:i}=this.range(),{filters:n}=this;for(let l=s+1;l<=i;l+=1)for(let s=0;s<n.length;s+=1){const i=n[s],o=t(l,i.ci),c=o?o.text:"";if(!i.includes(c)){e.add(l);break}r.add(l)}}return{rset:e,fset:r}}items(t,e){const r={};if(this.active()){const{sri:s,eri:i}=this.range();for(let n=s+1;n<=i;n+=1){const s=e(n,t);if(null===s||/^\s*$/.test(s.text))r[""]=(r[""]||0)+1;else{const t=s.text,e=(r[t]||0)+1;r[t]=e}}}return r}range(){return t.CellRange.valueOf(this.ref)}hrange(){const t=this.range();return t.eri=t.sri,t}clear(){this.ref=null,this.filters=[],this.sort=null}active(){return null!==this.ref}}});
//# sourceMappingURL=../sourcemaps/core/auto_filter.js.map
