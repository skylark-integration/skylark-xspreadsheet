{"version":3,"sources":["component/calendar.js"],"names":["define","m_element","Icon","m_locale","addMonth","date","step","setMonth","getMonth","weekday","index","d","Date","setDate","getDay","[object Object]","value","this","cvalue","headerLeftEl","h","bodyEl","buildAll","el","children","on","prev","child","next","t","map","week","selectChange","buildHeaderLeft","buildBody","html","getFullYear","trs","year","month","cdate","startDate","datess","i","j","disabled","active","getDate","monthDays","it","tds","it1","cls","toString"],"mappings":";;;;;;;AAAAA,QACI,YACA,SACA,oBACD,SAAUC,EAAWC,EAAMC,GAC1B,aACA,SAASC,EAASC,EAAMC,GACpBD,EAAKE,SAASF,EAAKG,WAAaF,GAEpC,SAASG,EAAQJ,EAAMK,GACnB,MAAMC,EAAI,IAAIC,KAAKP,GAEnB,OADAM,EAAEE,QAAQH,EAAQL,EAAKS,SAAW,GAC3BH,EAmFX,aArDII,YAAYC,GACRC,KAAKD,MAAQA,EACbC,KAAKC,OAAS,IAAIN,KAAKI,GACvBC,KAAKE,aAAelB,EAAUmB,EAAE,MAAO,wBACvCH,KAAKI,OAASpB,EAAUmB,EAAE,QAAS,IACnCH,KAAKK,WACLL,KAAKM,GAAKtB,EAAUmB,EAAE,MAAO,0BAA0BI,SAASvB,EAAUmB,EAAE,MAAO,mBAAmBI,SAASP,KAAKE,aAAclB,EAAUmB,EAAE,MAAO,yBAAyBI,SAASvB,EAAUmB,EAAE,YAAa,iBAAiBK,GAAG,aAAc,IAAMR,KAAKS,QAAQC,MAAM,IAAIzB,EAAK,iBAAkBD,EAAUmB,EAAE,YAAa,iBAAiBK,GAAG,aAAc,IAAMR,KAAKW,QAAQD,MAAM,IAAIzB,EAAK,oBAAqBD,EAAUmB,EAAE,QAAS,iBAAiBI,SAASvB,EAAUmB,EAAE,QAAS,IAAIO,MAAM1B,EAAUmB,EAAE,KAAM,IAAII,YAAYrB,EAAS0B,EAAE,kBAAkBC,IAAIC,GAAQ9B,EAAUmB,EAAE,KAAM,QAAQO,MAAMI,MAAUd,KAAKI,SAChmBJ,KAAKe,aAAe,SAGxBjB,SAASC,GACLC,KAAKD,MAAQA,EACbC,KAAKC,OAAS,IAAIN,KAAKI,GACvBC,KAAKK,WAETP,OACI,MAAMC,MAACA,GAASC,KAChBb,EAASY,GAAQ,GACjBC,KAAKK,WAETP,OACI,MAAMC,MAACA,GAASC,KAChBb,EAASY,EAAO,GAChBC,KAAKK,WAETP,WACIE,KAAKgB,kBACLhB,KAAKiB,YAETnB,kBACI,MAAMC,MAACA,GAASC,KAChBA,KAAKE,aAAagB,QAAShC,EAAS0B,EAAE,mBAAmBb,EAAMR,eAAiBQ,EAAMoB,iBAE1FrB,YACI,MAAMC,MAACA,EAAKE,OAAEA,EAAMG,OAAEA,GAAUJ,KAE1BoB,EAhEd,SAAmBC,EAAMC,EAAOC,GAC5B,MAAMC,EAAY,IAAI7B,KAAK0B,EAAMC,EAAO,EAAG,GAAI,GAAI,IAC7CG,sBAQN,IAAK,IAAIC,EAAI,EAAGA,EAAI,EAAGA,GAAK,EACxB,IAAK,IAAIC,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAAG,CAC3B,MACMjC,EAAIF,EAAQgC,EADA,EAAJE,EAAQC,GAEhBC,EAAWlC,EAAEH,aAAe+B,EAC5BO,EAASnC,EAAEH,aAAegC,EAAMhC,YAAcG,EAAEoC,YAAcP,EAAMO,UAC1EL,EAAOC,GAAGC,IACNjC,EAAAA,EACAkC,SAAAA,EACAC,OAAAA,GAIZ,OAAOJ,EAwCWM,CAAUhC,EAAMoB,cAAepB,EAAMR,WAAYU,GAC7CY,IAAImB,IAClB,MAAMC,EAAMD,EAAGnB,IAAIqB,IACf,IAAIC,EAAM,OAKV,OAJID,EAAIN,WACJO,GAAO,aACPD,EAAIL,SACJM,GAAO,WACJnD,EAAUmB,EAAE,KAAM,IAAIO,MAAM1B,EAAUmB,EAAE,MAAOgC,GAAK3B,GAAG,aAAc,KACxER,KAAKe,aAAamB,EAAIxC,KACvBgB,MAAMwB,EAAIxC,EAAEoC,UAAUM,eAE7B,OAAOpD,EAAUmB,EAAE,KAAM,IAAII,YAAY0B,KAE7C7B,EAAOc,KAAK,IAAIX,YAAYa","file":"../../component/calendar.js","sourcesContent":["define([\n    './element',\n    './icon',\n    '../locale/locale'\n], function (m_element, Icon, m_locale) {\n    'use strict';\n    function addMonth(date, step) {\n        date.setMonth(date.getMonth() + step);\n    }\n    function weekday(date, index) {\n        const d = new Date(date);\n        d.setDate(index - date.getDay() + 1);\n        return d;\n    }\n    function monthDays(year, month, cdate) {\n        const startDate = new Date(year, month, 1, 23, 59, 59);\n        const datess = [\n            [],\n            [],\n            [],\n            [],\n            [],\n            []\n        ];\n        for (let i = 0; i < 6; i += 1) {\n            for (let j = 0; j < 7; j += 1) {\n                const index = i * 7 + j;\n                const d = weekday(startDate, index);\n                const disabled = d.getMonth() !== month;\n                const active = d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();\n                datess[i][j] = {\n                    d,\n                    disabled,\n                    active\n                };\n            }\n        }\n        return datess;\n    }\n    \n\n    class Calendar {\n        constructor(value) {\n            this.value = value;\n            this.cvalue = new Date(value);\n            this.headerLeftEl = m_element.h('div', 'calendar-header-left');\n            this.bodyEl = m_element.h('tbody', '');\n            this.buildAll();\n            this.el = m_element.h('div', 'x-spreadsheet-calendar').children(m_element.h('div', 'calendar-header').children(this.headerLeftEl, m_element.h('div', 'calendar-header-right').children(m_element.h('m_element', 'calendar-prev').on('click.stop', () => this.prev()).child(new Icon('chevron-left')), m_element.h('m_element', 'calendar-next').on('click.stop', () => this.next()).child(new Icon('chevron-right')))), m_element.h('table', 'calendar-body').children(m_element.h('thead', '').child(m_element.h('tr', '').children(...m_locale.t('calendar.weeks').map(week => m_element.h('th', 'cell').child(week)))), this.bodyEl));\n            this.selectChange = () => {\n            };\n        }\n        setValue(value) {\n            this.value = value;\n            this.cvalue = new Date(value);\n            this.buildAll();\n        }\n        prev() {\n            const {value} = this;\n            addMonth(value, -1);\n            this.buildAll();\n        }\n        next() {\n            const {value} = this;\n            addMonth(value, 1);\n            this.buildAll();\n        }\n        buildAll() {\n            this.buildHeaderLeft();\n            this.buildBody();\n        }\n        buildHeaderLeft() {\n            const {value} = this;\n            this.headerLeftEl.html(`${ m_locale.t('calendar.months')[value.getMonth()] } ${ value.getFullYear() }`);\n        }\n        buildBody() {\n            const {value, cvalue, bodyEl} = this;\n            const mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);\n            const trs = mDays.map(it => {\n                const tds = it.map(it1 => {\n                    let cls = 'cell';\n                    if (it1.disabled)\n                        cls += ' disabled';\n                    if (it1.active)\n                        cls += ' active';\n                    return m_element.h('td', '').child(m_element.h('div', cls).on('click.stop', () => {\n                        this.selectChange(it1.d);\n                    }).child(it1.d.getDate().toString()));\n                });\n                return m_element.h('tr', '').children(...tds);\n            });\n            bodyEl.html('').children(...trs);\n        }\n    }\n\n    return Calendar;\n});"]}