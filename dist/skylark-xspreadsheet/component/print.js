/**
 * skylark-xspreadsheet - A version of xspreadsheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./element","../config","./button","../canvas/draw","./table","../locale/locale"],function(e,t,i,n,s,a){"use strict";const r=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],c=["landscape","portrait"];function h(e){return parseInt(96*e,10)}function d(e){"cancel"===e?this.el.hide():this.toPrint()}return class{constructor(n){this.paper={w:h(r[0][1]),h:h(r[0][2]),padding:50,orientation:c[0],get width(){return"landscape"===this.orientation?this.undefined:this.w},get height(){return"landscape"===this.orientation?this.w:this.undefined}},this.data=n,this.el=e.h("div",`${t.cssPrefix}-print`).children(e.h("div",`${t.cssPrefix}-print-bar`).children(e.h("div","-title").child("Print settings"),e.h("div","-right").children(e.h("div",`${t.cssPrefix}-buttons`).children(new i("cancel").on("click",d.bind(this,"cancel")),new i("next","primary").on("click",d.bind(this,"next"))))),e.h("div",`${t.cssPrefix}-print-content`).children(this.contentEl=e.h("div","-content"),e.h("div","-sider").child(e.h("form","").children(e.h("fieldset","").children(e.h("label","").child(`${a.t("print.size")}`),e.h("select","").children(...r.map((t,i)=>e.h("option","").attr("value",i).child(`${t[0]} ( ${t[1]}''x${t[2]}'' )`))).on("change",function(e){const{paper:t}=this,{value:i}=e.target,n=r[i];t.w=h(n[1]),t.undefined=h(n[2]),this.preview()}.bind(this))),e.h("fieldset","").children(e.h("label","").child(`${a.t("print.orientation")}`),e.h("select","").children(...c.map((t,i)=>e.h("option","").attr("value",i).child(`${a.t("print.orientations")[i]}`))).on("change",function(e){const{paper:t}=this,{value:i}=e.target,n=c[i];t.orientation=n,this.preview()}.bind(this))))))).hide()}resetData(e){this.data=e}preview(){const{data:i,paper:a}=this,{width:r,height:c,padding:h}=a,d=r-2*h,l=c-2*h,o=i.contentRange(),p=parseInt(o.undefined/l,10)+1,f=d/o.w;let v=h;const u=h;f>1&&(v+=(d-o.w)/2);let w=0,g=0;this.contentEl.html(""),this.canvases=[];const b={sri:0,sci:0,eri:0,eci:0};for(let a=0;a<p;a+=1){let a=0,h=0;const d=e.h("div",`${t.cssPrefix}-canvas-card`),p=e.h("canvas",`${t.cssPrefix}-canvas`);this.canvases.push(p.el);const $=new n.Draw(p.el,r,c);for($.save(),$.translate(v,u),f<1&&$.scale(f,f);w<=o.eri;w+=1){const e=i.rows.getHeight(w);if(!((a+=e)<l)){h=-(a-e);break}for(let e=0;e<=o.eci;e+=1)s.renderCell($,i,w,e,g),b.eci=e}b.eri=w,$.restore(),$.save(),$.translate(v,u),f<1&&$.scale(f,f);const x=g;i.eachMergesInView(b,({sri:e,sci:t})=>{s.renderCell($,i,e,t,x)}),$.restore(),b.sri=b.eri,b.sci=b.eci,g+=h,this.contentEl.child(e.h("div",`${t.cssPrefix}-canvas-card-wraper`).child(d.child(p)))}this.el.show()}toPrint(){this.el.hide();const{paper:t}=this,i=e.h("iframe","").hide(),{el:n}=i;window.document.body.appendChild(n);const{contentWindow:s}=n,a=s.document,r=document.createElement("style");r.innerHTML=`\n      @page { size: ${t.width}px ${t.height}px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    `,a.head.appendChild(r),this.canvases.forEach(e=>{const t=e.cloneNode(!1);t.getContext("2d").drawImage(e,0,0),a.body.appendChild(t)}),s.print()}}});
//# sourceMappingURL=../sourcemaps/component/print.js.map
