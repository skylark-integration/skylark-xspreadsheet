/**
 * skylark-xspreadsheet - A version of xspreadsheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./element","./event","./tooltip","./dropdown_font","./dropdown_fontsize","./dropdown_format","./dropdown_formula","./dropdown_color","./dropdown_align","./dropdown_border","./dropdown","./icon","../config","../locale/locale"],function(t,e,i,l,o,r,n,s,h,a,d,c,g,f){"use strict";function b(e){return t.h("div",`${g.cssPrefix}-toolbar-btn`).on("mouseenter",t=>{i(e,t.target)}).attr("data-tooltip",e)}function m(){return t.h("div",`${g.cssPrefix}-toolbar-divider`)}function u(t,e,i=(()=>{})){return b(t).child((l=e,new c(l))).on("click",()=>i());var l}function p(t){let e=t;const i=t.split("-");i.length>1&&i.forEach((t,i)=>{0===i?e=t:e+=t[0].toUpperCase()+t.substring(1)});const l=this[`${e}El`];l.toggle(),this.change(t,l.hasClass("active"))}class w extends d{constructor(){const e=new c("ellipsis"),i=t.h("div",`${g.cssPrefix}-toolbar-more`);super(e,"auto",!1,"bottom-right",i),this.moreBtns=i,this.contentEl.css("max-width","420px")}}function E(){const{el:t,btns:e,moreEl:i,ddMore:l,btns2:o}=this,{moreBtns:r,contentEl:n}=l;t.css("width",`${this.widthFn()-60}px`);const s=t.box();let h=160,a=12;const d=[],c=[];o.forEach(([t,e],i)=>{h+=e,i===o.length-1||h<s.width?d.push(t):(a+=e,c.push(t))}),e.html("").children(...d),r.html("").children(...c),n.css("width",`${a}px`),c.length>0?i.show():i.hide()}return class{constructor(i,d,c=!1){this.data=i,this.change=(()=>{}),this.widthFn=d;const $=i.defaultStyle();this.ddFormat=new r,this.ddFont=new l,this.ddFormula=new n,this.ddFontSize=new o,this.ddTextColor=new s("text-color",$.color),this.ddFillColor=new s("fill-color",$.bgcolor),this.ddAlign=new h(["left","center","right"],$.align),this.ddVAlign=new h(["top","middle","bottom"],$.valign),this.ddBorder=new a,this.ddMore=new w,this.btnChildren=[this.undoEl=u(`${f.t("toolbar.undo")} (Ctrl+Z)`,"undo",()=>this.change("undo")),this.redoEl=u(`${f.t("toolbar.undo")} (Ctrl+Y)`,"redo",()=>this.change("redo")),this.paintformatEl=u(`${f.t("toolbar.paintformat")}`,"paintformat",()=>p.call(this,"paintformat")),this.clearformatEl=u(`${f.t("toolbar.clearformat")}`,"clearformat",()=>this.change("clearformat")),m(),b(`${f.t("toolbar.format")}`).child(this.ddFormat.el),m(),b(`${f.t("toolbar.font")}`).child(this.ddFont.el),b(`${f.t("toolbar.fontSize")}`).child(this.ddFontSize.el),m(),this.fontBoldEl=u(`${f.t("toolbar.fontBold")} (Ctrl+B)`,"bold",()=>p.call(this,"font-bold")),this.fontItalicEl=u(`${f.t("toolbar.fontItalic")} (Ctrl+I)`,"italic",()=>p.call(this,"font-italic")),this.underlineEl=u(`${f.t("toolbar.underline")} (Ctrl+U)`,"underline",()=>p.call(this,"underline")),this.strikeEl=u(`${f.t("toolbar.strike")}`,"strike",()=>p.call(this,"strike")),b(`${f.t("toolbar.textColor")}`).child(this.ddTextColor.el),m(),b(`${f.t("toolbar.fillColor")}`).child(this.ddFillColor.el),b(`${f.t("toolbar.border")}`).child(this.ddBorder.el),this.mergeEl=u(`${f.t("toolbar.merge")}`,"merge",()=>p.call(this,"merge")),m(),b(`${f.t("toolbar.align")}`).child(this.ddAlign.el),b(`${f.t("toolbar.valign")}`).child(this.ddVAlign.el),this.textwrapEl=u(`${f.t("toolbar.textwrap")}`,"textwrap",()=>p.call(this,"textwrap")),m(),this.freezeEl=u(`${f.t("toolbar.freeze")}`,"freeze",()=>p.call(this,"freeze")),this.autofilterEl=u(`${f.t("toolbar.autofilter")}`,"autofilter",()=>p.call(this,"autofilter")),b(`${f.t("toolbar.formula")}`).child(this.ddFormula.el),this.moreEl=b(`${f.t("toolbar.more")}`).child(this.ddMore.el).hide()],this.el=t.h("div",`${g.cssPrefix}-toolbar`),this.btns=t.h("div",`${g.cssPrefix}-toolbar-btns`).children(...this.btnChildren),this.el.child(this.btns),c&&this.el.hide(),function(){this.ddFormat.change=(t=>this.change("format",t.key)),this.ddFont.change=(t=>this.change("font-name",t.key)),this.ddFormula.change=(t=>this.change("formula",t.key)),this.ddFontSize.change=(t=>this.change("font-size",t.pt)),this.ddTextColor.change=(t=>this.change("color",t)),this.ddFillColor.change=(t=>this.change("bgcolor",t)),this.ddAlign.change=(t=>this.change("align",t)),this.ddVAlign.change=(t=>this.change("valign",t)),this.ddBorder.change=(t=>this.change("border",t))}.call(this),this.reset(),setTimeout(()=>{(function(){this.btns2=this.btnChildren.map(t=>{const e=t.box(),{marginLeft:i,marginRight:l}=t.computedStyle();return[t,e.width+parseInt(i,10)+parseInt(l,10)]})}).call(this),E.call(this)},0),e.bind(window,"resize",()=>{E.call(this)})}paintformatActive(){return this.paintformatEl.hasClass("active")}paintformatToggle(){this.paintformatEl.toggle()}trigger(t){p.call(this,t)}reset(){const{data:t}=this,e=t.getSelectedCellStyle(),i=t.getSelectedCell();this.undoEl.disabled(!t.canUndo()),this.redoEl.disabled(!t.canRedo()),this.mergeEl.active(t.canUnmerge()).disabled(!t.selector.multiple()),this.autofilterEl.active(!t.canAutofilter());const{font:l}=e;this.ddFont.setTitle(l.name),this.ddFontSize.setTitle(l.size),this.fontBoldEl.active(l.bold),this.fontItalicEl.active(l.italic),this.underlineEl.active(e.underline),this.strikeEl.active(e.strike),this.ddTextColor.setTitle(e.color),this.ddFillColor.setTitle(e.bgcolor),this.ddAlign.setTitle(e.align),this.ddVAlign.setTitle(e.valign),this.textwrapEl.active(e.textwrap),this.freezeEl.active(t.freezeIsActive()),i&&i.format&&this.ddFormat.setTitle(i.format)}}});
//# sourceMappingURL=../sourcemaps/component/toolbar.js.map
