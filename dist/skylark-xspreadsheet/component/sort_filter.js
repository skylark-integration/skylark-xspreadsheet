/**
 * skylark-xspreadsheet - A version of xspreadsheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./element","./button","./event","../config","../locale/locale"],function(e,t,i,s,l){"use strict";function c(t){return e.h("div",`${s.cssPrefix}-item ${t}`)}function h(e){return c("state").child(l.t(`sort.${e}`)).on("click.stop",()=>this.itemClick(e))}function r(){const{filterhEl:e,filterValues:t,values:i}=this;e.html(`${t.length} / ${i.length}`),e.checked(t.length===i.length)}return class{constructor(){this.filterbEl=e.h("div",`${s.cssPrefix}-body`),this.filterhEl=e.h("div",`${s.cssPrefix}-header state`).on("click.stop",()=>this.filterClick(0,"all")),this.el=e.h("div",`${s.cssPrefix}-sort-filter`).children(this.sortAscEl=h.call(this,"asc"),this.sortDescEl=h.call(this,"desc"),c("divider"),e.h("div",`${s.cssPrefix}-filter`).children(this.filterhEl,this.filterbEl),e.h("div",`${s.cssPrefix}-buttons`).children(new t("cancel").on("click",()=>this.btnClick("cancel")),new t("ok","primary").on("click",()=>this.btnClick("ok")))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}btnClick(e){if("ok"===e){const{ci:e,sort:t,filterValues:i}=this;this.ok&&this.ok(e,t,"in",i)}this.hide()}itemClick(e){this.sort=e;const{sortAscEl:t,sortDescEl:i}=this;t.checked("asc"===e),i.checked("desc"===e)}filterClick(t,i){const{filterbEl:s,filterValues:l,values:c}=this,h=s.children();if("all"===i)h.length===l.length?(this.filterValues=[],h.forEach(t=>e.h(t).checked(!1))):(this.filterValues=Array.from(c),h.forEach(t=>e.h(t).checked(!0)));else{e.h(h[t]).toggle("checked")?l.push(i):l.splice(l.findIndex(e=>e===i),1)}r.call(this)}set(t,i,c,h){this.ci=t;const{sortAscEl:n,sortDescEl:o}=this;null!==h?(this.sort=h.order,n.checked(h.asc()),o.checked(h.desc())):(this.sortDesc=null,n.checked(!1),o.checked(!1)),this.values=Object.keys(i),this.filterValues=c?Array.from(c.value):Object.keys(i),function(t){const{filterbEl:i,filterValues:c}=this;i.html(""),Object.keys(t).forEach((h,r)=>{const n=t[h],o=c.includes(h)?"checked":"";i.child(e.h("div",`${s.cssPrefix}-item state ${o}`).on("click.stop",()=>this.filterClick(r,h)).children(""===h?l.t("filter.empty"):h,e.h("div","label").html(`(${n})`)))})}.call(this,i,c),r.call(this)}setOffset(e){this.el.offset(e).show();let t=1;i.bindClickoutside(this.el,()=>{t<=0&&this.hide(),t-=1})}show(){this.el.show()}hide(){this.el.hide(),i.unbindClickoutside(this.el)}}});
//# sourceMappingURL=../sourcemaps/component/sort_filter.js.map
