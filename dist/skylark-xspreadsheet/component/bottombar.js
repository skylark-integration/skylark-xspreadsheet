/**
 * skylark-xspreadsheet - A version of xspreadsheet.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./element","./event","../config","./icon","./form_input","./dropdown","./message","../locale/locale"],function(t,e,i,s,l,h,c,n){"use strict";const a=[{key:"delete",title:n.tf("contextmenu.deleteSheet")}];function o(){return a.map(e=>(function(e){return t.h("div",`${i.cssPrefix}-item`).child(e.title()).on("click",()=>{this.itemClick(e.key),this.hide()})}).call(this,e))}return class{constructor(l=(()=>{}),n=(()=>{}),a=(()=>{}),d=(()=>{})){this.swapFunc=n,this.updateFunc=d,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new class extends h{constructor(t){super(new s("ellipsis"),"auto",!1,"top-left"),this.contentClick=t}reset(e){const s=e.map((e,s)=>t.h("div",`${i.cssPrefix}-item`).css("width","150px").css("font-weight","normal").on("click",()=>{this.contentClick(s),this.hide()}).child(e));this.setContentChildren(...s)}setTitle(){}}(t=>{this.clickSwap2(this.items[t])}),this.contextMenu=new class{constructor(){this.el=t.h("div",`${i.cssPrefix}-contextmenu`).css("width","160px").children(...o.call(this)).hide(),this.itemClick=(()=>{})}hide(){const{el:t}=this;t.hide(),e.unbindClickoutside(t)}setOffset(t){const{el:i}=this;i.offset(t),i.show(),e.bindClickoutside(i)}},this.contextMenu.itemClick=a,this.el=t.h("div",`${i.cssPrefix}-bottombar`).children(this.contextMenu.el,this.menuEl=t.h("ul",`${i.cssPrefix}-menu`).child(t.h("li","").children(new s("add").on("click",()=>{this.dataNames.length<10?l():c.xtoast("tip","it less than or equal to 10")}),t.h("span","").child(this.moreEl))))}addItem(e,i){this.dataNames.push(e);const s=t.h("li",i?"active":"").child(e);s.on("click",()=>{this.clickSwap2(s)}).on("contextmenu",t=>{const{offsetLeft:e,offsetHeight:i}=t.target;this.contextMenu.setOffset({left:e,bottom:i+1}),this.deleteEl=s}).on("dblclick",()=>{const t=s.html(),e=new l("auto","");e.val(t),e.input.on("blur",({target:e})=>{const{value:i}=e,s=this.dataNames.findIndex(e=>e===t);this.renameItem(s,i)}),s.html("").child(e.el),e.focus()}),i&&this.clickSwap(s),this.items.push(s),this.menuEl.child(s),this.moreEl.reset(this.dataNames)}renameItem(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}clear(){this.items.forEach(t=>{this.menuEl.removeChild(t.el)}),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}deleteItem(){const{activeEl:t,deleteEl:e}=this;if(this.items.length>1){const i=this.items.findIndex(t=>t===e);if(this.items.splice(i,1),this.dataNames.splice(i,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){const[t]=this.items;return this.activeEl=t,this.activeEl.toggle(),[i,0]}return[i,-1]}return[-1]}clickSwap2(t){const e=this.items.findIndex(e=>e===t);this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}clickSwap(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}});
//# sourceMappingURL=../sourcemaps/component/bottombar.js.map
